<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
	<meta http-equiv="content-type" content="text/html; charset=utf-8" />
	<title>Prova Timeline</title>
	<script type="text/javascript" src="http://maps.google.com/maps/api/js?sensor=false"></script>
	<script type="text/javascript" src="../lib/jquery-1.6.2.min.js"></script>
	<script type="text/javascript" src="../lib/mxn/mxn.js?(googlev3)"></script>
	<script type="text/javascript" src="../lib/timeline-1.2.js"></script>
	<script src="../src/timemap.js" type="text/javascript"></script>
	<script src="../src/manipulation.js" type="text/javascript"></script>

	<link href="css/StyleOverlay.css" rel="stylesheet" />
	<script type="text/javascript" src="../lib/JavaScriptOverlay.js"></script>
	<link href="css/index.css" rel="stylesheet" />

	<!--bootstrap-->
	<link href="../bootstrap/css/bootstrap.css" rel="stylesheet" />
	<script type="text/javascript" src="http://code.jquery.com/jquery-latest.js"></script>
	<script type="text/javascript" src="../bootstrap/js/bootstrap.min.js"></script>
	<link href="../bootstrap/css/bootstrap-toggle-buttons.css" rel="stylesheet" />
	<script type="text/javascript" src="../bootstrap/js/jquery.toggle.buttons.js"></script>

	<!--overlapping-->
	<script type="text/javascript" src="../lib/oms.min.js"></script>

	<!--gestione pagina-->
	<script type="text/javascript" src="../lib/Gestione.js"></script>

	<script type="text/javascript">
		var tm;
		$(function () {
			// make a custom map style
			var styledMapType = new google.maps.StyledMapType([
				{
					featureType: "water",
					elementType: "all",
					stylers: [
					  { saturation: 0 },
					  { lightness: 100 }
					]
				},
				{
					featureType: "all",
					elementType: "all",
					stylers: [
					  { saturation: -100 }
					]
				}
			], {
				name: "white"
			});
			//bottone read more nei bubble delle descrizioni
			var ReadMore = "<button id=\"apri\" class=\"btn btn-primary\" onmousedown=\"ApriOverlay()\">Read More...</button>";
			//inizializzazione TimeMap
			tm = TimeMap.init({
				mapId: "map",               // Id of map div element (required)
				timelineId: "timeline",     // Id of timeline div element (required)
				options: {
					eventIconPath: "../images/"
				},
				bandIntervals: "mon", //date nell' ordine di mese/anno
				//yr -> year, decade

				datasets: [
					//Ugo Fantozzi
					{
						id: "Fantozzi",
						title: "Prova",
						// note that the lines below are now the preferred syntax
						type: "basic",
						theme: "red",
						options: {
							items: [

								{
									"start": "1934-07-17",
									//"end": "1934-07-17",
									"point": {
										"lat": 44.43476,
										"lon": 8.944015
									},
									"title": "Nascita Fantozzi",
									"options": {
										theme: new TimeMapTheme({
											icon: "../images/markerIcons/largeTDRedIcons/marker1.png", //marker mappa
											iconSize: [20, 34],
											iconAnchor: [10, 35],
											eventIconImage: "../images/red-circle.png", //immagine timeline
											color: "red" //colore dell' evento
										}),
										// set the full HTML for the info window
										"infoHtml": "Nascita Fantozzi"
									}
								},
								{
									"start": "1960-09-09",
									//"end": "1960-09-09",
									"point": {
										"lat": 46.072397,
										"lon": 11.120882
									},
									"title": "Matrimonio Fantozzi",
									"options": {
										theme: new TimeMapTheme({
											icon: "../images/markerIcons/largeTDRedIcons/marker2.png", //marker mappa
											iconSize: [20, 34],
											iconAnchor: [10, 35],
											eventIconImage: "../images/red-circle.png", //immagine timeline
											color: "red" //colore dell' evento
										}),
										// set the full HTML for the info window
										"infoHtml": "Matrimonio Fantozzi"
									}
								},
								//linea temporale Fantozzi
								{
									start: "1934-07-17",
									end: "1960-09-09",
									polyline: [
										{ lat: 44.43476, lon: 8.944015 },
										{ lat: 46.072397, lon: 11.120882 },
									],
									title: "Vita Fantozzi",
									options: {
										description: "Vita Fantozzi",
										theme: "red",
										// any additional theme settings can go here
										lineWeight: 5
									}
								}
							]
						}
					},
					//Bruno Kessler
					{
						id: "Kessler",
						title: "Prova",
						// note that the lines below are now the preferred syntax
						type: "basic",
						options: {
							items: [
								{
									"start": "1924-02-17",
									//"end": "1924-02-17",
									"point": {
										"lat": 46.363603,
										"lon": 10.672871
									},
									"title": "Nascita Kessler",
									"options": {
										//il tema va applicato nelle options!!!
										theme: new TimeMapTheme({
											icon: "../images/markerIcons/largeTDBlueIcons/marker1.png", //marker mappa
											iconSize: [20, 34],
											iconAnchor: [10, 35], //devo cambiare il punto di ancoraggio dell' icona xk le dimensioni dei nuovi marker sono diverse
											eventIconImage: "../images/blue-circle.png", //immagine timeline
											color: "#5A7ACF" //colore dell' evento
										}),
										// set the full HTML for the info window
										infoHtml: "Nascita Kessler...<br/><br/><img src=\"../images/imgPersonaggi/kesslerNascita.jpg\" /><br/><br/>" + ReadMore
									},

								},
								{
									"start": "1950-01-01",
									"end": "1950-12-31",
									"point": {
										"lat": 45.417612,
										"lon": 11.871836
									},
									"title": "Laurea di Kessler presso Università degli Studi di Padova",
									"options": {
										theme: new TimeMapTheme({
											icon: "../images/markerIcons/largeTDBlueIcons/marker2.png", //marker mappa
											iconSize: [20, 34],
											iconAnchor: [10, 35],
											//eventIconImage: "../images/blue-circle.png", //immagine timeline
											color: "#5A7ACF" //colore dell' evento
										}),
										// set the full HTML for the info window
										//"infoHtml": "Laurea di Kessler presso Università degli Studi di Padova"
										infoHtml: "Laurea di Kessler presso Università degli Studi di Padova...<br/><br/><img src=\"../images/imgPersonaggi/kesslerUni.jpg\" /><br/><br/>" + ReadMore,
									}
								},
								{
									"start": "1956",
									"end": "1976",
									"point": {
										"lat": 46.067827,
										"lon": 11.121014
									},
									"title": "Concilio di Trento con Kessler",
									"options": {
										theme: new TimeMapTheme({
											icon: "../images/markerIcons/largeTDBlueIcons/marker3.png", //marker mappa
											iconSize: [20, 34],
											iconAnchor: [10, 35],
											//eventIconImage: "../images/blue-circle.png", //immagine timeline
											color: "#5A7ACF" //colore dell' evento
										}),
										// set the full HTML for the info window
										//"infoHtml": "Laurea di Kessler presso Università degli Studi di Padova"
										infoHtml: "Concilio di Trento con Kessler...<br/><br/><img src=\"../images/imgPersonaggi/kesslerConcilio.jpg\" /><br/><br/>" + ReadMore,
									}
								},
								//linea temporale Kessler
								{
									start: "1924-02-17",
									end: "1976",
									polyline: [
										{ lat: 46.363603, lon: 10.672871 },
										{ lat: 45.417612, lon: 11.871836 },
										{ lat: 46.067827, lon: 11.121014 },
									],
									title: "Vita Kessler",
									options: {
										description: "Vita Kessler",
										theme: "blue",
										// any additional theme settings can go here
										lineWeight: 5
									}
								}
							]
						}
					}
				]
			});
			// set the map to our custom style
			var gmap = tm.getNativeMap();
			gmap.mapTypes.set("white", styledMapType);
			gmap.setMapTypeId("white");


			//gestione overlapping
			//!!!usare sempre getNativeMap che ritorna l' oggetto mappa!
			//con il secondo parametro faccio in mondo che lo spyderfly rimanga anche dopo il clik (devo cliccare sulla mappa per farlo scomparire)
			var oms = new OverlappingMarkerSpiderfier(gmap, { markersWontMove: true, keepSpiderfied: true });

			oms.addListener('click', function (marker) {
				tm.getSelected().openInfoWindow();
			});
			oms.addListener('spiderfy', function (markers) {
				//tm.getSelected().closeInfoWindow();				
			});
			oms.addListener('unspiderfy', function (markers) {
				//tm.getSelected().closeInfoWindow();
			});
			//recupero il vettore di tutti gli item!!
			var a = tm.getItems();
			for (var i = 0; i < a.length; i++) {
				//devo prenderli dentro tutti!!!! con getNativePlacemark() recupero il marker di ogni Item della TimeMap!!!
				a[i].closeInfoWindow();
				oms.addMarker(a[i].getNativePlacemark());  // <-- here
			}

			//devo inizializzare i toggle-button!
			$('.toggle-button-class').toggleButtons({
				width: 220,
				label: {
					enabled: "Show",
					disabled: "Not Show"
				}
			});
		});
	</script>
	
</head>

<body>
	<div id="container" style="width: 1024px; margin-right: auto; margin-left: auto;">
		<div id="header" style="width: 800px; margin-right: auto; margin-left: auto; padding: 5px; text-align: center;">
			<img src="../images/layout/cover-flatten.png" />
		</div>
		<!--div necessari per l' overlay-->
		<div class="overlay" id="overlay" style="display: none;"></div>
		<!--contenuto overlay-->

		<div id="box">
			<div class="split_sx">
				<h1 class="titolo_box"></h1>
				<p class="testo-box"></p>
				<img id="img_overlay" class="testo-box" src="" />
				<!--				<hr />-->
			</div>
			<div class="split_dx">
				<!--<h3>Immagini del tempo</h3>-->
				<!--<p>Prova</p>-->
				<div class="tabbable">
					<!-- Only required for left/right tabs -->
					<ul class="nav nav-tabs">
						<li class="active"><a href="#eventi" data-toggle="tab">Eventi</a></li>
						<li><a href="#immagini" data-toggle="tab">Immagini</a></li>
						<li><a href="#video" data-toggle="tab">Video</a></li>
					</ul>
					<div class="tab-content">
						<div class="tab-pane active" id="eventi">
							<p>
								Il Concilio di Trento o Concilio Tridentino fu il XIX concilio ecumenico della Chiesa cattolica, 
								aperto da papa Paolo III nel 1545 e chiuso, dopo numerose interruzioni, nel 1563. Con questo 
								concilio venne definita la riforma della Chiesa cattolica (Controriforma) e la reazione alle 
								dottrine del calvinismo e luteranesimo (Riforma protestante), con il fine di rafforzare l'autorità papale, 
								seriamente minacciata dalla diffusione del luteranesimo. Fu un concilio importante per la storia della Chiesa
								cattolica, tanto che l'aggettivo "tridentino" viene usato ancora oggi per definire alcuni aspetti
								caratteristici della Chiesa cattolica ereditati da questo concilio e mantenuti per i successivi tre 
								secoli, fino ai concili Vaticano I e Vaticano II.
							</p>
						</div>
						<div class="tab-pane" id="immagini" style="padding:5px;">
							<img src="../images/imgOverlay/1956_06Congr.jpg" />
							<br />
							<br />
							<img src="../images/imgOverlay/7145486.jpg" />
							<br />
							<br />
							<img src="../images/imgOverlay/955d_35.jpg" />
							<br />
							<br />
							<img src="../images/imgOverlay/inaugurazione.jpg" />
						</div>
						<div class="tab-pane" id="video" style="margin-right: auto; margin-left: auto; padding: 5px; text-align: center;">
							<p>Breve video sul concilio di Trento</p>
							<iframe width="350" height="200" src="http://www.youtube.com/embed/4Vhzc4ayx3M" frameborder="0" allowfullscreen></iframe>
						</div>
					</div>
				</div>
			</div>
			<!--<p class="chiudi">X</p>-->
			<img src="../images/layout/X.png" class="chiudi" />
		</div>
		<!--fine box-->


		<div id="info" style="text-align: center; padding: 5px;">
			<br />
			<!--<h1 style="color: white">Prova timeline</h1>-->
			<!--<p class="lead" style="color: white">Prova timeline</p>-->

			<div>
				<button class="btn-large btn-primary" onclick="CambioScalaTimelineGiorno()">Giorno-Mese</button>&nbsp&nbsp&nbsp
				<button class="btn-large btn-primary" onclick="CambioScalaTimelineMese()">Mese-Anno</button>&nbsp&nbsp&nbsp
				<button class="btn-large btn-primary" onclick="CambioScalaTimelineAnno()">Anno-Decade</button>&nbsp&nbsp&nbsp
				<button class="btn-large btn-primary" onclick="CambioScalaTimelineDecade()">Decade-Secolo</button>&nbsp&nbsp&nbsp
				<br />
			</div>

			<br />
			<h2 style="color: white;">Fantozzi & Kessler</h2>

			<!--<p style="color: white">Show:</p>-->
			<div style="float: left; width: 50%;">
				<!--cambiato il metodo on click con onchange e usato l' attributo for per allineare la label sopra al toggle-button-->
				<label for="checkbox1" style="color: white">Fantozzi</label>
				<div class="toggle-button-class">
					<input id="checkbox1" type="checkbox" onchange="toggleDataset('Fantozzi', this.checked);" checked="checked" />
				</div>
			</div>
			<div style="float: left; width: 50%;">
				<label for="checkbox1" style="color: white">Kessler</label>
				<div class="toggle-button-class">
					<input id="checkbox2" type="checkbox" onchange="toggleDataset('Kessler', this.checked);" checked="checked" />
				</div>
			</div>

			<br />

		</div>

		<!--bisogna aggiungere clear:left altrimenti la mappa viene allineata a sx come i div sopra-->
		<div id="timemap" style="clear: left;">
			<div id="mapcontainer">
				<div id="map" style="-moz-border-radius: 10px 10px 0px 0px; -webkit-border-radius: 10px 10px 0px 0px; border-radius: 10px 10px 0px 0px;">
				</div>
			</div>
			<div id="timelinecontainer">
				<div id="timeline" style="-moz-border-radius: 0px 0px 10px 10px; -webkit-border-radius: 0px 0px 10px 10px; border-radius: 0px 0px 10px 10px;"></div>
			</div>
		</div>
	</div>
</body>
</html>
